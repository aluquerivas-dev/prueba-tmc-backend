spring.application.name=similar-products
server.port=5000

# Cliente HTTP configurable con timeouts ajustados
external.api.base-url=http://localhost:3001
external.api.connection-timeout=3000
external.api.response-timeout=3000
external.api.max-connections=500
external.api.acquire-timeout=2000

# Configuración de paralelización
app.similar-products.concurrency=15

# Configuración de caché
spring.cache.cache-names=similarProductIds,productDetails
spring.cache.caffeine.spec=maximumSize=1000,expireAfterWrite=5m

# Actuator endpoints y métricas
management.endpoints.web.exposure.include=health,info,metrics,prometheus,circuitbreakers,circuitbreakerevents
management.endpoint.health.show-details=always
management.metrics.tags.application=${spring.application.name}
management.metrics.distribution.percentiles-histogram.http.server.requests=true

# Configuración de logging
logging.level.org.springframework.web.reactive.function.client=INFO
logging.level.com.aluquerivas.similar_products=INFO
logging.pattern.console=%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n

# Configuración de timeouts (en milisegundos)
app.similar-products.timeout.product-detail=3000
app.similar-products.timeout.global-request=10000
app.similar-products.timeout.api-client=2000

# Circuit Breaker configuration
resilience4j.circuitbreaker.instances.productApiClient.sliding-window-size=10
resilience4j.circuitbreaker.instances.productApiClient.failure-rate-threshold=50
resilience4j.circuitbreaker.instances.productApiClient.wait-duration-in-open-state=10000
resilience4j.circuitbreaker.instances.productApiClient.permitted-number-of-calls-in-half-open-state=5
resilience4j.circuitbreaker.instances.productApiClient.slow-call-rate-threshold=50
resilience4j.circuitbreaker.instances.productApiClient.slow-call-duration-threshold=2000
resilience4j.circuitbreaker.instances.productApiClient.register-health-indicator=true

# Time Limiter configuration
resilience4j.timelimiter.instances.productApiClient.timeout-duration=3000
resilience4j.timelimiter.instances.productApiClient.cancel-running-future=true

# Retry configuration
resilience4j.retry.instances.productApiClient.max-attempts=3
resilience4j.retry.instances.productApiClient.wait-duration=1000
resilience4j.retry.instances.productApiClient.retry-exceptions=java.io.IOException,java.net.ConnectException,org.springframework.web.reactive.function.client.WebClientResponseException
resilience4j.retry.instances.productApiClient.backoff-multiplier=1.5

# Bulkhead configuration
resilience4j.bulkhead.instances.productApiClient.max-concurrent-calls=20
resilience4j.bulkhead.instances.productApiClient.max-wait-duration=500ms
